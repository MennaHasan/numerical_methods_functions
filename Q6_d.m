%preparing constants to use
Pa = [1:1:450];
Pb = 100;

k1 = (0.0128*200)/(0.12)^2;
k2 = (0.0128*200)/(0.1)^2;
k3 = (0.0128*200)/(0.1)^2;
k4 = (0.0128*100)/(0.06)^2;
k5 = (0.0128*150)/(0.08)^2;
k6 = (0.0128*150)/(0.08)^2;
k7 = (0.0128*100)/(0.06)^2;

p1 = zeros(450,1);
p2 = zeros(450,1);
p3 = zeros(450,1);
p4 = zeros(450,1);

for i = 1:450
    %preparing a and b
    a = zeros(11);
    b = zeros(11,1);
    a(1,:) = [1,0,0,0,k1,0,0,0,0,0,0];
    b(1,1) =  Pa(i);
    a(2,:) = [1,-1,0,0,0,-k2,0,0,0,0,0];
    b(2,1) =  0;
    a(3,:) = [1,0,-1,0,0,0,-k3,0,0,0,0];
    b(3,1) =  0;
    a(4,:) = [0,1,-1,0,0,0,0,-k4,0,0,0];
    b(4,1) =  0;
    a(5,:) = [0,1,0,-1,0,0,0,0,-k5,0,0];
    b(5,1) =  0;
    a(6,:) = [0,0,1,-1,0,0,0,0,0,-k6,0];
    b(6,1) =  0;
    a(7,:) = [0,0,0,1,0,0,0,0,0,0,-k7];
    b(7,1) =  Pb;
    a(8,:) = [0,0,0,0,1,-1,-1,0,0,0,0];
    b(8,1) =  0;
    a(9,:) = [0,0,0,0,0,0,1,1,0,-1,0];
    b(9,1) =  0;
    a(10,:) = [0,0,0,0,0,1,0,-1,-1,0,0];
    b(10,1) =  0;
    a(11,:) = [0,0,0,0,0,0,0,0,1,1,-1];
    b(11,1) =  0;

    %calling the function
    out = Q6_b(a,b);
    p1(i) = out(1);
    p2(i) = out(2);
    p3(i) = out(3);
    p4(i) = out(4);
end
figure;
title('pa vs P1-P4')
plot(Pa,p1);

hold on;
plot(Pa,p2);

hold on;
plot(Pa,p3);

hold on;
plot(Pa,p4);
legend('p1','p2','p3','p4');
